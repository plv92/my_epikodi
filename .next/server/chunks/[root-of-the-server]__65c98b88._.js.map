{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 68, "column": 0}, "map": {"version":3,"sources":["file:///home/plv92/Desktop/TEK3/Epikodi/src/app/api/favorites/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { PrismaClient } from \"@prisma/client\";\n\nconst prisma = new PrismaClient();\n\n// GET /api/favorites - Liste tous les favoris\nexport async function GET(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const type = searchParams.get('type'); // Filtrer par type optionnel\n\n    const where = type ? { type } : {};\n\n    const favorites = await prisma.favorite.findMany({\n      where,\n      include: {\n        track: true,\n      },\n      orderBy: {\n        createdAt: 'desc',\n      },\n    });\n\n    return NextResponse.json(favorites);\n  } catch (error) {\n    console.error(\"Erreur API favorites:\", error);\n    return NextResponse.json([], { status: 200 });\n  }\n}\n\n// POST /api/favorites - Ajoute un favori\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const { type, trackId, movieId, seriesId } = body;\n\n    if (!type) {\n      return NextResponse.json({ error: \"Le type est requis\" }, { status: 400 });\n    }\n\n    // Vérifier qu'il n'existe pas déjà\n    const existing = await prisma.favorite.findFirst({\n      where: {\n        type,\n        trackId: trackId || null,\n        movieId: movieId || null,\n        seriesId: seriesId || null,\n      },\n    });\n\n    if (existing) {\n      return NextResponse.json({ error: \"Déjà dans les favoris\" }, { status: 400 });\n    }\n\n    const favorite = await prisma.favorite.create({\n      data: {\n        type,\n        trackId: trackId || null,\n        movieId: movieId || null,\n        seriesId: seriesId || null,\n      },\n      include: {\n        track: true,\n      },\n    });\n\n    return NextResponse.json(favorite, { status: 201 });\n  } catch (error) {\n    return NextResponse.json({ error: \"Erreur lors de l'ajout aux favoris\" }, { status: 500 });\n  }\n}\n\n// DELETE /api/favorites - Retire un favori\nexport async function DELETE(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const id = searchParams.get('id');\n\n    if (!id) {\n      return NextResponse.json({ error: \"ID requis\" }, { status: 400 });\n    }\n\n    await prisma.favorite.delete({\n      where: { id: parseInt(id) },\n    });\n\n    return NextResponse.json({ message: \"Favori supprimé\" });\n  } catch (error) {\n    return NextResponse.json({ error: \"Erreur lors de la suppression du favori\" }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;AAEA,MAAM,SAAS,IAAI,6HAAA,CAAA,eAAY;AAGxB,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,OAAO,aAAa,GAAG,CAAC,SAAS,6BAA6B;QAEpE,MAAM,QAAQ,OAAO;YAAE;QAAK,IAAI,CAAC;QAEjC,MAAM,YAAY,MAAM,OAAO,QAAQ,CAAC,QAAQ,CAAC;YAC/C;YACA,SAAS;gBACP,OAAO;YACT;YACA,SAAS;gBACP,WAAW;YACb;QACF;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,EAAE,EAAE;YAAE,QAAQ;QAAI;IAC7C;AACF;AAGO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG;QAE7C,IAAI,CAAC,MAAM;YACT,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAqB,GAAG;gBAAE,QAAQ;YAAI;QAC1E;QAEA,mCAAmC;QACnC,MAAM,WAAW,MAAM,OAAO,QAAQ,CAAC,SAAS,CAAC;YAC/C,OAAO;gBACL;gBACA,SAAS,WAAW;gBACpB,SAAS,WAAW;gBACpB,UAAU,YAAY;YACxB;QACF;QAEA,IAAI,UAAU;YACZ,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAwB,GAAG;gBAAE,QAAQ;YAAI;QAC7E;QAEA,MAAM,WAAW,MAAM,OAAO,QAAQ,CAAC,MAAM,CAAC;YAC5C,MAAM;gBACJ;gBACA,SAAS,WAAW;gBACpB,SAAS,WAAW;gBACpB,UAAU,YAAY;YACxB;YACA,SAAS;gBACP,OAAO;YACT;QACF;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,UAAU;YAAE,QAAQ;QAAI;IACnD,EAAE,OAAO,OAAO;QACd,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAqC,GAAG;YAAE,QAAQ;QAAI;IAC1F;AACF;AAGO,eAAe,OAAO,OAAoB;IAC/C,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,KAAK,aAAa,GAAG,CAAC;QAE5B,IAAI,CAAC,IAAI;YACP,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAY,GAAG;gBAAE,QAAQ;YAAI;QACjE;QAEA,MAAM,OAAO,QAAQ,CAAC,MAAM,CAAC;YAC3B,OAAO;gBAAE,IAAI,SAAS;YAAI;QAC5B;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAkB;IACxD,EAAE,OAAO,OAAO;QACd,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA0C,GAAG;YAAE,QAAQ;QAAI;IAC/F;AACF","debugId":null}}]
}